<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{siteLayouts/masterLayout}">
<head>
	<title th:utext="#{title.search.result}"></title>
</head>
<body>
<h1 layout:fragment="h1" id="wb-cont" th:utext="#{title.search.result}"></h1>
<div layout:fragment="siteContent">
	<div class="row mrgn-bttm-lg">
		<div class="col-md-6">
			<a th:href="@{/search}" th:utext="#{label.results.new.search}"/>
		</div>
	</div>

	<!--	&lt;!&ndash;Display application error messages&ndash;&gt;
        <div class="mrgn-tp-md mrgn-bttm-lg">
            <logic:present name="org.apache.struts.action.ACTION_MESSAGE" scope="request" >
                <div class="alert alert-danger">
                    <html:messages id="message"	message="true" bundle="messageRes">
                        <h2><bean:write name="message" /></h2>
                    </html:messages>
                </div>
            </logic:present>

            &lt;!&ndash;Display validation error messages&ndash;&gt;
            <logic:present name="org.apache.struts.action.ERROR" scope="request">
                <div class="alert alert-danger">
                    <h2><bean:message bundle="messageRes" key="error.message" /></h2>
                    <html:errors bundle="messageRes" />
                </div>
            </logic:present>
        </div> -->

	<h2 th:utext="#{label.results.criteria}"/>
	<div th:if="${session.searchForm.din != ''}">
		<p th:utext="#{label.criteria.drug.din} + ' ' + ${session.searchForm.din}"/>
	</div>
	<div th:unless="${session.searchForm.din != ''}">
		<ul class="noBullet">
			<div th:if="${session.searchForm.atc != ''}">
				<li th:utext="#{label.criteria.drug.atc} + ' ' + ${session.searchForm.atc}"/>
			</div>
			<div th:unless="${session.searchForm.atc != ''}">
				<li><div class="indent2" th:utext="#{label.criteria.drug.status} + ' ' + ${session.searchForm.selectedStatusText}"/></li>
				<div th:if="${session.searchForm.companyName}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.company} + ' ' + ${session.searchForm.companyName}"/></li>
				</div>
				<div th:if="${session.searchForm.brandName != ''}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.product} + ' ' + ${session.searchForm.brandName}"/></li>
				</div>
				<div th:if="${session.searchForm.activeIngredient != ''}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.ai} + $' ' + {session.searchForm.activeIngredient}"/></li>
				</div>
				<div th:if="${session.searchForm.aigNumber != ''}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.aig} + ' ' + ${session.searchForm.aigNumber}"/></li>
				</div>
				<div th:if="${session.searchForm.biosimDrugSearch}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.biosimDrug} + ' ' + #{label.results.yes}"/></li>
				</div>
				<div th:if="${session.searchForm.drugClass}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.class} + ' ' + ${session.searchForm.drugClass}"/></li>
				</div>
				<div th:if="${session.searchForm.route}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.route} + ' ' + ${session.searchForm.route}"/></li>
				</div>
				<div th:if="${session.searchForm.dosage}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.dosage} + ' ' + ${session.searchForm.dosage}"/></li>
				</div>
				<div th:if="${session.searchForm.schedule}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.schedule} + ' ' + ${session.searchForm.schedule}"/></li>
				</div>
				<div th:if="${session.searchForm.vetSpecies}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.species} + ' ' + ${session.searchForm.vetSpecies}"/></li>
				</div>
			</div>
		</ul>
	</div>

        <h2><span th:utext="#{label.search.results}"/></h2>


	<!--        <c:choose>
                <c:when test="${result_count > 0 }">
                    <c:choose>
                        <c:when test="${result_count < 2000}">
                            <c:set var ='dataTableProcessing' value='{ "order" : [3, "asc"] }'/>
                        </c:when>
                        <c:otherwise>
                            <c:set var='dataTableProcessing' value='{ "order" : [3, "asc"],
                        "bServerSide": true,
                        "bProcessing": true,
                        "bFilter": false,
                        "sAjaxSource": "./search-recherche.do",
                        "sServerMethod" : "POST",
                        "sPaginationType": "full_numbers",
                        "aoColumns": [
                            { "mData": "status", "defaultContent": "" },
                            { "mData": "din", "defaultContent": "" },
                            { "mData": "company", "defaultContent": "" },
                            { "mData": "brand", "defaultContent": "" },
                            { "mData": "drugClass", "defaultContent": "" },
                            { "mData": "pm", "defaultContent": "" },
                            { "mData": "schedule", "defaultContent": "" },
                            { "mData": "aiNum", "defaultContent": "" },
                            { "mData": "majorAI", "defaultContent": "" },
                            { "mData": "AIStrength", "defaultContent": "", "bSearchable": false, "bSortable": false }
                            ],
                        "iDisplayLength": ${page_length},
                        "iDeferLoading": ${result_count}
                         }'/>
                        </c:otherwise>
                    </c:choose>
    !-->
			%%<span th:utext="${dpdSearchResults?.size}" /><br />==
			**<span th:utext="${dpdSearchResults?.size < 2000 ? abc : xyz}" />
	<table class="wb-tables table">
               <!-- <table id="results" class="table table-striped table-condensed table-bordered wb-tables"
					   data-wb-tables='{ "order" : [3, "asc"] }}' >
                       &lt;!&ndash;data-wb-tables='${dataTableProcessing}'>  todo&ndash;&gt;
                    <caption class="text-left"><span th:utext="#{table.search.results.caption}"/><br><span class="wb-inv"><span th:utext="#{table.search.results.summary}"/></span></caption>
                    -->
                    <thead>
                    <tr>
                        <th id="status" scope="col" th:utext="#{label.results.status}"></th>
                        <th id="din" scope="col" th:utext="#{label.results.din}"></th>
                       <th id="company" scope="col" th:utext="#{label.results.company}"></th>
                        <th id="brand" scope="col" th:utext="#{label.results.product}"></th>
                        <th id="drugClass" scope="col" th:utext="#{label.results.drug.class}"></th>
                        <th id="pm" scope="col"><span th:utext="#{label.results.pm}" />
                            <sup id="fn1-rf"><a class="fn-lnk" href="#fn1"><span class="wb-inv" th:utext="#{label.results.see.footnote}"/>1</a></sup>
                        </th>

                        <th id="schedule" scope="col" th:utext="#{label.results.schedule}"></th>
                        <th id="aiNum" scope="col"><span th:utext="#{label.results.ai.count}" />
                            <sup id="fn2-rf"><a class="fn-lnk" href="#fn2"><span class="wb-inv" th:utext="#{label.results.see.footnote}"/>2</a></sup>
                        </th>
                        <th id="majorAI" scope="col"><span th:utext="#{label.results.ai.major}" />
                            <sup id="fn3-rf"><a class="fn-lnk" href="#fn3"><span class="wb-inv" th:utext="#{label.results.see.footnote}"/>3</a></sup>
                        </th>
                        <th id="AIStrength" scope="col" th:utext="#{label.results.ai.major.strength}"></th>

                    </tr>
                    </thead>
                    <tbody>
                        <tr th:each="rec : ${dpdSearchResults}">

                            <td>
                                <span th:text="${rec.status}" /></td>
                            <td>
                                <!--<bean:define id="code" name="element" property="id" />
                                <%
                                java.util.HashMap params2= new java.util.HashMap();
                                params2.put("code", code);
                                params2.put("lang", lang);
                                pageContext.setAttribute("paramsName2", params2);

                                %>
                                <html:link action="info" name="paramsName2">
                                    <bean:write name="element" property="din"/>
                                </html:link>-->
								<a th:href="@{/info/{id}(id=${rec.drugCode})}" th:text="${rec.din}">DIN</a>
                            </td>
                            <td><span th:text="${rec.companyName}"></span></td>-
							<td>
								<!-- <logic:notEmpty name="element" property="brandNameLangOfPart">
                                     <bean:define id="brandLangOfPart" name="element" property="brandNameLangOfPart"></bean:define>
                                     <span xml:lang='<%= brandLangOfPart %>' lang='<%= brandLangOfPart %>'><bean:write name="element" property="brandName"/></span>
                                 </logic:notEmpty>
                                 <logic:empty name="element" property="brandNameLangOfPart">
                                     <bean:write name="element" property="brandName"/>
                                 </logic:empty>-->
								<span xml:lang='${rec.brandLangOfPart}' lang='${rec.brandLangOfPart}' th:if= "${rec.brandLangOfPart != ''}"  th:text='${rec.brandName}' />
								<span th:if= "${rec.brandLangOfPart == ''}"  th:text='${rec.brandName}' />
							</td>
							<td>
								<!--<logic:notEmpty name="element" property="classLangOfPart">
                                    <bean:define id="classLangOfPart" name="element" property="classLangOfPart"></bean:define>
                                    <span xml:lang='<%= classLangOfPart %>' lang='<%= classLangOfPart %>'><bean:write name="element" property="drugClass"/></span>
                                </logic:notEmpty>
                                <logic:empty name="element" property="classLangOfPart">
                                    <bean:write name="element" property="drugClass"/>
                                </logic:empty>-->
								<span xml:lang='${rec.classLangOfPart}' lang='${rec.classLangOfPart}' th:if= "${rec.classLangOfPart != ''}"  th:text='${rec.drugClass}' />
								<span th:if= "${rec.classLangOfPart == ''}"  th:text='${rec.drugClass}' />
							</td>
							<!--<logic:notEqual name="element" property="pm" value="">-->
							<td><span th:utext="#{label.results.yes}"/></td>
							<!--</logic:notEqual>
                            <logic:equal name="element" property="pm" value="">
                                <td><span th:utext="#{label.results.no}"/></td>
                            </logic:equal>-->
							<td>
								<!-- <logic:notEmpty name="element" property="scheduleLangOfPart">
                                     <bean:define id="scheduleLangOfPart" name="element" property="scheduleLangOfPart"></bean:define>
                                     <span xml:lang='<%= scheduleLangOfPart %>' lang='<%= scheduleLangOfPart %>'><bean:write name="element" property="schedule"/></span>
                                 </logic:notEmpty>
                                 <logic:empty name="element" property="scheduleLangOfPart">
                                     <bean:write name="element" property="schedule"/>
                                 </logic:empty>-->
								<span xml:lang='${rec.scheduleLangOfPart}' lang='${rec.scheduleLangOfPart}' th:if= "${rec.scheduleLangOfPart != ''}"  th:text='${rec.schedule}' />
								<span th:if= "${rec.scheduleLangOfPart == ''}"  th:text='${rec.schedule}' />
							</td>
							<td><span th:text="${rec.numberOfAis}"></span></td>
							<td>
								<!--<bean:define id="firstAILangOfPart" name="element" property="firstAILangOfPart"></bean:define>
                                <logic:notEmpty name="firstAILangOfPart">
                             <span xml:lang='<%= firstAILangOfPart %>' lang='<%= firstAILangOfPart %>'>
                             <bean:write name="element" property="firstAIName"/></span>
                                </logic:notEmpty>
                                <logic:empty name="firstAILangOfPart">
                                    <bean:write name="element" property="firstAIName"/>
                                </logic:empty>-->
								<span xml:lang='${rec.firstAILangOfPart}' lang='${rec.firstAILangOfPart}' th:if= "${rec.firstAILangOfPart != ''}"  th:text='${rec.firstAIName}' />
								<span th:if= "${rec.firstAILangOfPart == ''}"  th:text='${rec.firstAIName}' />
							</td>

							<td>
								<!--<logic:empty name="element" property="aiStrengthAndDosageLangOfPart">
                                    <bean:write name="element" property="aiStrengthAndDosageText"/>
                                </logic:empty>
                                <%&#45;&#45; If aiStrengthAndDosageLangOfPart is not empty, both the strength unit and the dosage unit must be tested individually,
                                and tagged individually for language of part if necessary &#45;&#45;%>
                                <logic:notEmpty name="element" property="aiStrengthAndDosageLangOfPart">
                                    <logic:notEmpty name="element" property="aiStrengthLangOfPart">
                                        <bean:define id="strengthLangOfPart" name="element" property="aiStrengthLangOfPart"></bean:define>
                                        <bean:write name="element" property="strength"/>
                                        <span xml:lang='<%= strengthLangOfPart %>' lang='<%= strengthLangOfPart %>'><bean:write name="element" property="strengthUnit"/></span>
                                    </logic:notEmpty>
                                    <logic:empty name="element" property="aiStrengthLangOfPart">
                                        <bean:write name="element" property="aiStrengthText"/>
                                    </logic:empty>

                                    <logic:notEmpty name="element" property="aiDosageLangOfPart">
                                        <bean:define id="dosageLangOfPart" name="element" property="aiDosageLangOfPart"></bean:define>
                                        <logic:notEmpty name="element" property="dosageValue">
                                            <logic:notEmpty name="element" property="dosageUnit">
                                                <span th:utext="#{label.product.per"/>&nbsp;<bean:write name="element" property="dosageValue"/>
                                                <span xml:lang='<%= dosageLangOfPart %>' lang='<%= dosageLangOfPart %>'><bean:write name="element" property="dosageUnit"/></span>
                                            </logic:notEmpty>
                                        </logic:notEmpty>
                                        <logic:empty name="element" property="dosageValue" >
                                            <logic:notEmpty name="element" property="dosageUnit">
                                                <logic:notEqual name="element" property="dosageUnit" value="%">
                                                    <span th:utext="#{label.product.per"/>&nbsp;
                                                    <span xml:lang='<%= dosageLangOfPart %>' lang='<%= dosageLangOfPart %>'><bean:write name="element" property="dosageUnit"/></span>
                                                </logic:notEqual>
                                            </logic:notEmpty>
                                        </logic:empty>
                                    </logic:notEmpty>
                                    <logic:empty name="element" property="aiDosageLangOfPart">
                                        <bean:write name="element" property="aiDosageText"/>
                                    </logic:empty>
                                </logic:notEmpty>-->
							</td>
                        </tr>
                    </tbody>
                </table>

<!--                <aside class="wb-fnote wb-fnote-inited" role="note">
                    <h3 id="fn"><span th:utext="#{label.results.table.footnotes"/></h3>
                    <dl>
                        <dt id="fn1-dt"><span th:utext="#{label.results.footnote"/> 1</dt>
                        <dd aria-labelledby="fn1-dt" tabindex="-1" id="fn1">
                            <p><span th:utext="#{label.legend.pm"/></p>
                            <p class="fn-rtn"><a href="#fn1-rf"><span class="wb-inv"><span th:utext="#{label.results.return.to.footnote"/> </span>1<span class="wb-inv"> <span th:utext="#{label.results.referrer"/></span></a></p>
                        </dd>

                        <dt id="fn2-dt"><span th:utext="#{label.results.footnote"/> 2</dt>
                        <dd aria-labelledby="fn2-dt" tabindex="-1" id="fn2">
                            <p><span th:utext="#{label.legend.ai"/></p>
                            <p class="fn-rtn"><a href="#fn2-rf"><span class="wb-inv"><span th:utext="#{label.results.return.to.footnote"/> </span>2<span class="wb-inv"> <span th:utext="#{label.results.referrer"/></span></a></p>
                        </dd>
                        <dt id="fn3-dt"><span th:utext="#{label.results.footnote"/> 3</dt>
                        <dd aria-labelledby="fn3-dt" tabindex="-1" id="fn3">
                            <p><span th:utext="#{label.legend.ai.name"/></p>
                            <p class="fn-rtn"><a href="#fn3-rf"><span class="wb-inv"><span th:utext="#{label.results.return.to.footnote"/> </span>3<span class="wb-inv"> <span th:utext="#{label.results.referrer"/></span></a></p>
                        </dd>
                    </dl>
                </aside>
            </c:when>
            <c:otherwise>
                <div class="alert alert-info"><h3><bean:message bundle="messageRes" key="message.no.match" /></h3><p><bean:message bundle="messageRes" key="message.no.records" /></p></div>
            </c:otherwise>
        </c:choose>

        <div class="row mrgn-tp-md">
            <div class="col-md-6">
                <html:link forward ="SearchPage" name="paramsName">
                    <span th:utext="#{label.results.new.search"/>
                </html:link>
            </div>
        </div>-->
</div>
</body>
</html>