<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="~{siteLayouts/masterLayout}">
<head>
	<title th:utext="#{title.search.result}"></title>
</head>
<body>
<h1 layout:fragment="h1" id="wb-cont" th:utext="#{title.search.result}"></h1>
<div layout:fragment="siteContent">
	<div class="row mrgn-bttm-lg">
		<th:block th:insert="/includes/newSearchLink :: newSearchLink"></th:block>
	</div>

	<!--	&lt;!&ndash;Display application error messages&ndash;&gt;
        <div class="mrgn-tp-md mrgn-bttm-lg">
            <logic:present name="org.apache.struts.action.ACTION_MESSAGE" scope="request" >
                <div class="alert alert-danger">
                    <html:messages id="message"	message="true" bundle="messageRes">
                        <h2><bean:write name="message" /></h2>
                    </html:messages>
                </div>
            </logic:present>

            &lt;!&ndash;Display validation error messages&ndash;&gt;
            <logic:present name="org.apache.struts.action.ERROR" scope="request">
                <div class="alert alert-danger">
                    <h2><bean:message bundle="messageRes" key="error.message" /></h2>
                    <html:errors bundle="messageRes" />
                </div>
            </logic:present>
        </div> -->

	<h2 th:utext="#{label.results.criteria}"/>
	<div th:if="${session.searchForm.din != ''}">
		<p th:utext="#{label.criteria.drug.din} + ' ' + ${session.searchForm.din}"/>
	</div>
	<div th:unless="${session.searchForm.din != ''}">
		<ul class="noBullet">
			<div th:if="${session.searchForm.atc != ''}">
				<li th:utext="#{label.criteria.drug.atc} + ' ' + ${session.searchForm.atc}"/>
			</div>
			<div th:unless="${session.searchForm.atc != ''}">
				<li><div class="indent2" th:utext="#{label.criteria.drug.status} + ' ' + ${session.searchForm.selectedStatusText}"/></li>
				<div th:if="${session.searchForm.companyName}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.company} + ' ' + ${session.searchForm.companyName}"/></li>
				</div>
				<div th:if="${session.searchForm.brandName != ''}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.product} + ' ' + ${session.searchForm.brandName}"/></li>
				</div>
				<div th:if="${session.searchForm.activeIngredient != ''}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.ai} + $' ' + {session.searchForm.activeIngredient}"/></li>
				</div>
				<div th:if="${session.searchForm.aigNumber != ''}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.aig} + ' ' + ${session.searchForm.aigNumber}"/></li>
				</div>
				<div th:if="${session.searchForm.biosimDrugSearch}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.biosimDrug} + ' ' + #{label.results.yes}"/></li>
				</div>
				<div th:if="${session.searchForm.drugClass}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.class} + ' ' + ${session.searchForm.drugClass}"/></li>
				</div>
				<div th:if="${session.searchForm.route}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.route} + ' ' + ${session.searchForm.route}"/></li>
				</div>
				<div th:if="${session.searchForm.dosage}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.dosage} + ' ' + ${session.searchForm.dosage}"/></li>
				</div>
				<div th:if="${session.searchForm.schedule}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.schedule} + ' ' + ${session.searchForm.schedule}"/></li>
				</div>
				<div th:if="${session.searchForm.vetSpecies}">
					<li><div class="indent2" th:utext="#{label.criteria.drug.species} + ' ' + ${session.searchForm.vetSpecies}"/></li>
				</div>
			</div>
		</ul>
	</div>

        <h2><span th:utext="#{label.search.results}"/></h2>


	<!--        <c:choose>
                <c:when test="${result_count > 0 }">
                    <c:choose>
                        <c:when test="${result_count < 2000}">
                            <c:set var ='dataTableProcessing' value='{ "order" : [3, "asc"] }'/>
                        </c:when>
                        <c:otherwise>
                            <c:set var='dataTableProcessing' value='{ "order" : [3, "asc"],
                        "bServerSide": true,
                        "bProcessing": true,
                        "bFilter": false,
                        "sAjaxSource": "./search-recherche.do",
                        "sServerMethod" : "POST",
                        "sPaginationType": "full_numbers",
                        "aoColumns": [
                            { "mData": "status", "defaultContent": "" },
                            { "mData": "din", "defaultContent": "" },
                            { "mData": "company", "defaultContent": "" },
                            { "mData": "brand", "defaultContent": "" },
                            { "mData": "drugClass", "defaultContent": "" },
                            { "mData": "pm", "defaultContent": "" },
                            { "mData": "schedule", "defaultContent": "" },
                            { "mData": "aiNum", "defaultContent": "" },
                            { "mData": "majorAI", "defaultContent": "" },
                            { "mData": "AIStrength", "defaultContent": "", "bSearchable": false, "bSortable": false }
                            ],
                        "iDisplayLength": ${page_length},
                        "iDeferLoading": ${result_count}
                         }'/>
                        </c:otherwise>
                    </c:choose>
    !-->
			%%<span th:utext="${dpdSearchResults?.size}" /><br />==
			**<span th:utext="${dpdSearchResults==null}" />
		<div th:if="${dpdSearchResults?.size > 0}">
			<table class="wb-tables table">
               <!-- <table id="results" class="table table-striped table-condensed table-bordered wb-tables"
					   data-wb-tables='{ "order" : [3, "asc"] }}' >
                       &lt;!&ndash;data-wb-tables='${dataTableProcessing}'>  todo&ndash;&gt;-->
                    <caption class="text-left"><span th:utext="#{table.search.results.caption}"/><br><span class="wb-inv"><span th:utext="#{table.search.results.summary}"/></span></caption>
                    <thead>
                    <tr>
                        <th id="status" scope="col" th:utext="#{label.results.status}"></th>
                        <th id="din" scope="col" th:utext="#{label.results.din}"></th>
                       <th id="company" scope="col" th:utext="#{label.results.company}"></th>
                        <th id="brand" scope="col" th:utext="#{label.results.product}"></th>
                        <th id="drugClass" scope="col" th:utext="#{label.results.drug.class}"></th>
                        <th id="pm" scope="col"><span th:utext="#{label.results.pm}" />
                            <sup id="fn1-rf"><a class="fn-lnk" href="#fn1"><span class="wb-inv" th:utext="#{label.results.see.footnote}"/>1</a></sup>
                        </th>

                        <th id="schedule" scope="col" th:utext="#{label.results.schedule}"></th>
                        <th id="aiNum" scope="col"><span th:utext="#{label.results.ai.count}" />
                            <sup id="fn2-rf"><a class="fn-lnk" href="#fn2"><span class="wb-inv" th:utext="#{label.results.see.footnote}"/>2</a></sup>
                        </th>
                        <th id="majorAI" scope="col"><span th:utext="#{label.results.ai.major}" />
                            <sup id="fn3-rf"><a class="fn-lnk" href="#fn3"><span class="wb-inv" th:utext="#{label.results.see.footnote}"/>3</a></sup>
                        </th>
                        <th id="AIStrength" scope="col" th:utext="#{label.results.ai.major.strength}"></th>

                    </tr>
                    </thead>
                    <tbody>
                        <tr th:each="rec : ${dpdSearchResults}">
                            <td><span th:text="${rec.status}" /></td>
                            <td>
								<a th:href="@{/info/{id}(id=${rec.drugCode})}" th:text="${rec.din}">DIN</a>
                            </td>
                            <td><span th:text="${rec.companyName}"></span></td>-
							<td>
								<span xml:lang='${rec.brandLangOfPart}' lang='${rec.brandLangOfPart}' th:if= "${rec.brandLangOfPart != ''}"  th:text='${rec.brandName}' />
								<span th:if= "${rec.brandLangOfPart == ''}"  th:text='${rec.brandName}' />
							</td>
							<td>
								<span xml:lang='${rec.classLangOfPart}' lang='${rec.classLangOfPart}' th:if= "${rec.classLangOfPart != ''}"  th:text='${rec.drugClass}' />
								<span th:if= "${rec.classLangOfPart == ''}"  th:text='${rec.drugClass}' />
							</td>
							<td><span th:utext="${rec.pm}"/></td>
							<td>
								<span xml:lang='${rec.scheduleLangOfPart}' lang='${rec.scheduleLangOfPart}' th:if= "${rec.scheduleLangOfPart != ''}"  th:text='${rec.schedule}' />
								<span th:if= "${rec.scheduleLangOfPart == ''}"  th:text='${rec.schedule}' />
							</td>
							<td><span th:text="${rec.numberOfAis}"></span></td>
							<td>
								<span xml:lang='${rec.firstAILangOfPart}' lang='${rec.firstAILangOfPart}' th:if= "${rec.firstAILangOfPart != ''}"  th:text='${rec.firstAIName}' />
								<span th:if= "${rec.firstAILangOfPart == ''}"  th:text='${rec.firstAIName}' />
							</td>

							<td>
								<span th:if= "${rec.aiStrengthAndDosageLangOfPart == ''}"  th:text='${rec.aiStrengthAndDosageText}' />
								<div th:if= "${rec.aiStrengthAndDosageLangOfPart != ''}" >
									<!-- If aiStrengthAndDosageLangOfPart is not empty, both the strength unit and the dosage unit must be tested individually,
									and tagged individually for language of part if necessary -->
									<div th:if= "${rec.aiStrengthLangOfPart != ''">
										<span th:text='${rec.strength}' />
										<span xml:lang='${rec.strengthLangOfPart}' lang='${rec.strengthLangOfPart}' th:text='${rec.strengthUnit}' />
									</div>
									<span th:if= "${rec.aiStrengthLangOfPart == ''}"  th:text='${rec.aiStrengthText}' />

									<div th:if= "${rec.aiDosageLangOfPart != ''">
										<div th:if= "${rec.dosageValue != ''}">
											<div th:if="${rec.dosageUnit != ''}" >
												<span th:utext="#{label.product.per}" />&nbsp;<span th:utext="${rec.dosageValue}"/>
												<span xml:lang='${rec.aiDosageLangOfPart}' lang='${rec.aiDosageLangOfPart}' th:text='${rec.dosageUnit}' />
											</div>
										</div>
										<div th:if= "${rec.dosageValue == ''}">
											<div th:if="${rec.dosageUnit != ''} and ${rec.dosageUnit != '%'}" >
												<span th:utext="#{label.product.per}"/>>&nbsp;
												<span xml:lang='${rec.aiDosageLangOfPart}' lang='${rec.aiDosageLangOfPart}' th:text='${rec.dosageUnit}' />
											</div>
										</div>
									</div>
									<span th:if= "${rec.aiDosageLangOfPart == ''}"  th:text='${rec.aiDosageText}' />
								</div>
							</td>
                        </tr>
                    </tbody>
                </table>

                <aside class="wb-fnote wb-fnote-inited" role="note">
                    <h3 id="fn"><span th:utext="#{label.results.table.footnotes}" /></h3>
					<dl>
						<dt id="fn1-dt"><span th:utext="#{label.results.footnote}" /> 1</dt>
						<dd aria-labelledby="fn1-dt" tabindex="-1" id="fn1">
							<p th:utext="#{label.legend.pm}" />
							<p class="fn-rtn"><a href="#fn1-rf"><span class="wb-inv" th:utext="#{label.results.return.to.footnote}" />1<span class="wb-inv" th:utext="#{label.results.referrer}"/></a></p>
						</dd>
						<dt id="fn2-dt"><span th:utext="#{label.results.footnote}" /> 2</dt>
						<dd aria-labelledby="fn2-dt" tabindex="-1" id="fn2">
							<p th:utext="#{label.legend.ai}" />
							<p class="fn-rtn"><a href="#fn2-rf"><span class="wb-inv" th:utext="#{label.results.return.to.footnote}" />2<span class="wb-inv" th:utext="#{label.results.referrer}"/></a></p>
						</dd>
						<dt id="fn3-dt"><span th:utext="#{label.results.footnote}" /> 3</dt>
						<dd aria-labelledby="fn3-dt" tabindex="-1" id="fn3">
							<p th:utext="#{label.legend.ai.name}" />
							<p class="fn-rtn"><a href="#fn3-rf"><span class="wb-inv" th:utext="#{label.results.return.to.footnote}" />3<span class="wb-inv" th:utext="#{label.results.referrer}"/></a></p>
						</dd>

					</dl>
                </aside>
		</div>
        <div class="alert alert-info" th:if="${dpdSearchResults?.size == 0}"><h3 th:utext="#{message.no.match}" /><p th:utext="#{message.no.records}" /></div>

        <div class="row mrgn-tp-md">
            <div class="col-md-6">
				<th:block th:insert="/includes/newSearchLink :: newSearchLink"></th:block>
            </div>
        </div>

</div>
</body>
</html>